# Customer Churn Prediction App

An interactive **Streamlit web application** designed to predict customer churn using multiple machine learning models. This tool helps banks identify at-risk customers and implement proactive measures to enhance retention.

---

## Features

- **User-Friendly Interface**: Input customer details and receive immediate churn predictions.
- **Multi-Model Predictions**: Utilize various machine learning models for accurate and robust results.
- **Visual Insights**: Interactive charts to explore prediction probabilities.
- **Personalized Explanations**: Gain insights into the factors influencing each prediction.
- **Automated Outreach**: Generate customized emails to retain at-risk customers.

---

## Machine Learning Models Used

The application incorporates a diverse range of machine learning models to maximize prediction accuracy:

1. **XGBoost Classifier (`xgb_model.pkl`)**: High-performance gradient boosting algorithm.
2. **Random Forest Classifier (`rf_model.pkl`)**: Ensemble of decision trees to minimize overfitting.
3. **K-Nearest Neighbors (`knn_model.pkl`)**: Effective algorithm based on proximity to neighbors.
4. Additional Models:
   - Naive Bayes Classifier (`nb_model.pkl`)
   - Decision Tree Classifier (`dt_model.pkl`)
   - Support Vector Machine (`svm_model.pkl`)
   - **Voting Classifier (`voting_clf.pkl`)**: Combines multiple models for consensus predictions.
   - **XGBoost with SMOTE (`xgboost-SMOTE.pkl`)**: Tackles class imbalance using the Synthetic Minority Over-sampling Technique.
   - **XGBoost with Feature Engineering (`xgboost-featureEngineered.pkl`)**: Leverages engineered features to boost performance.

---

## Installation

### Clone the Repository

```bash
git clone https://github.com/your_username/your_repository.git
cd your_repository
```

### Create a Virtual Environment

```bash
python -m venv venv
```

### Activate the Virtual Environment

**Windows**:
```bash
venv\Scripts\activate
```

**macOS/Linux**:
```bash
source venv/bin/activate
```

### Install Dependencies

```bash
pip install -r requirements.txt
```

### Set Up Environment Variables

Obtain an API key for the OpenAI or Groq API. Then set the environment variable:

**Windows**:
```arduino
set GROQ_API_KEY=your_api_key_here
```

**macOS/Linux**:
```arduino
export GROQ_API_KEY='your_api_key_here'
```

---

## Run the Application

```arduino
streamlit run main.py
```

---

## Usage

1. Open a web browser and navigate to: `http://localhost:8501`.
2. Select a customer from the dropdown menu or input custom details.
3. View churn predictions generated by multiple models.
4. Examine detailed explanations for predictions.
5. Generate personalized emails for at-risk customers.

---

## Project Structure

- **`main.py`**: Main Streamlit application.
- **`utils.py`**: Utility functions for generating charts and processing data.
- **Models**: Directory containing pre-trained machine learning models (.pkl files).
- **`churn.csv`**: Dataset with customer information.

---

## Technologies Used

- **Python**
- **Streamlit**
- **Pandas** & **NumPy**
- **Scikit-learn**
- **XGBoost**
- **Plotly**
- **OpenAI/Groq API**
<br>
  
Screenshots: <br>
![image](https://github.com/user-attachments/assets/40ae1f5c-a092-4686-b33b-90e38b64ba4e)
![image](https://github.com/user-attachments/assets/30567da4-5940-4e28-96c6-be342978d398)
![image](https://github.com/user-attachments/assets/c6c43c8a-1537-448d-9bee-d9233932b8a1)
![image](https://github.com/user-attachments/assets/39e6bade-6c75-4dc1-b150-2fb96b0a972a)
